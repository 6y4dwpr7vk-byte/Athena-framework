<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Interactive diagnostic tool for boundary-respecting systems analysis.">
    <title>Interactive Diagnostic Tool — Athena</title>
    <link rel="stylesheet" href="/assets/styles.css">
</head>
<body>
    <nav>
        <div class="container">
            <a href="/" class="site-title">Athena</a>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/about/">About</a></li>
                <li><a href="/jbf/">JBF</a></li>
                <li><a href="/sociology/">Sociology</a></li>
                <li><a href="/diagnostic-class/">Diagnostic</a></li>
                <li><a href="/demo/" class="active">Demo</a></li>
                <li><a href="/examples/">Examples</a></li>
                <li><a href="/info/">Info</a></li>
            </ul>
        </div>
    </nav>

    <main class="container">
        <h1>Interactive Diagnostic Tool</h1>
        <p class="subtitle">Real-time boundary analysis application</p>

        <section>
            <h2>Tool Overview</h2>
            <p>
                This interactive tool applies the <a href="/jbf/">Judgment Boundary Framework</a> to institutional
                scenarios, providing real-time diagnostic assessment. The tool evaluates boundary behaviors and
                generates classification recommendations based on the <a href="/diagnostic-class/">diagnostic
                classification system</a>.
            </p>
            <p>
                Enter details about an institutional context below, and the tool will analyze boundary-respecting
                or boundary-violating characteristics.
            </p>
        </section>

        <section>
            <h2>Diagnostic Form</h2>
            <form id="diagnosticForm">
                <div class="form-group">
                    <label for="institutionName">Institution or System Name</label>
                    <input
                        type="text"
                        id="institutionName"
                        name="institutionName"
                        placeholder="e.g., University Review Committee, Healthcare Authorization System"
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="institutionType">Institution Type</label>
                    <select id="institutionType" name="institutionType" required>
                        <option value="">Select a type...</option>
                        <option value="academic">Academic Institution</option>
                        <option value="healthcare">Healthcare System</option>
                        <option value="regulatory">Regulatory/Licensing Body</option>
                        <option value="platform">Digital Platform</option>
                        <option value="government">Government Agency</option>
                        <option value="corporate">Corporate Organization</option>
                        <option value="other">Other</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="statedBoundaries">Stated Boundaries (Official Scope and Authority)</label>
                    <textarea
                        id="statedBoundaries"
                        name="statedBoundaries"
                        placeholder="Describe the formally documented boundaries, scope of authority, and evaluation criteria..."
                        required
                    ></textarea>
                </div>

                <div class="form-group">
                    <label for="observedBehaviors">Observed Behaviors (Actual Practices)</label>
                    <textarea
                        id="observedBehaviors"
                        name="observedBehaviors"
                        placeholder="Describe the actual decision-making patterns, judgment exercises, and boundary behaviors..."
                        required
                    ></textarea>
                </div>

                <div class="form-group">
                    <label for="specificConcerns">Specific Concerns or Questions (Optional)</label>
                    <textarea
                        id="specificConcerns"
                        name="specificConcerns"
                        placeholder="Any particular boundary issues or questions about this case..."
                    ></textarea>
                </div>

                <button type="submit" id="submitBtn">Analyze Boundary Behaviors</button>
            </form>
        </section>

        <section id="resultsSection" style="display: none;">
            <h2>Diagnostic Results</h2>
            <div id="diagnosticOutput" class="diagnostic-output">
                <div id="loadingIndicator" style="display: none;">
                    <p>Analyzing boundary behaviors...</p>
                </div>
                <div id="resultsContent"></div>
            </div>
        </section>

        <section>
            <h2>Using the Tool</h2>

            <h3>Input Guidelines</h3>
            <ul>
                <li><strong>Stated Boundaries:</strong> Include official policies, documented criteria, and formal scope definitions</li>
                <li><strong>Observed Behaviors:</strong> Describe actual practices, decision patterns, and specific cases</li>
                <li><strong>Be Specific:</strong> Include concrete examples and documented incidents when possible</li>
                <li><strong>Maintain Objectivity:</strong> Focus on observable behaviors rather than inferred intentions</li>
            </ul>

            <h3>Output Interpretation</h3>
            <p>
                The tool provides:
            </p>
            <ul>
                <li>Primary classification (A, B, or C) based on overall boundary behavior pattern</li>
                <li>Applicable sub-classifications for specific boundary behaviors</li>
                <li>Analysis of discrepancies between stated and enacted boundaries</li>
                <li>Preliminary recommendations for boundary clarification or remediation</li>
            </ul>

            <h3>Limitations</h3>
            <p>
                This tool provides preliminary diagnostic assessment based on submitted information. Comprehensive
                boundary analysis requires deeper institutional examination and may benefit from expert consultation.
                The tool serves as a starting point for systematic boundary evaluation, not as definitive judgment.
            </p>
        </section>

        <section>
            <h2>Related Resources</h2>
            <ul>
                <li><a href="/jbf/">Judgment Boundary Framework</a> — Complete analytical methodology</li>
                <li><a href="/diagnostic-class/">Diagnostic Classification</a> — Detailed classification criteria</li>
                <li><a href="/examples/">Worked Examples</a> — See the framework applied to real cases</li>
            </ul>
        </section>
    </main>

    <footer>
        <p>Athena — Boundary-Respecting Systems</p>
        <p class="text-secondary">Institutional analysis framework for judgment boundary mapping</p>
    </footer>

    <script>
        // The Bridge: JavaScript for handling form submission to Cloudflare Worker
        const diagnosticForm = document.getElementById('diagnosticForm');
        const resultsSection = document.getElementById('resultsSection');
        const diagnosticOutput = document.getElementById('diagnosticOutput');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const resultsContent = document.getElementById('resultsContent');
        const submitBtn = document.getElementById('submitBtn');

        diagnosticForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            // Show loading state
            resultsSection.style.display = 'block';
            loadingIndicator.style.display = 'block';
            resultsContent.innerHTML = '';
            diagnosticOutput.classList.add('loading');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Analyzing...';

            // Scroll to results
            resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });

            // Collect form data
            const formData = new FormData(diagnosticForm);

            try {
                // Send POST request to Cloudflare Worker
                const response = await fetch('http://localhost:8787', {
                    method: 'POST',
                    body: formData,
                    // Note: multipart/form-data Content-Type is automatically set by browser
                });

                if (!response.ok) {
                    throw new Error(`Server returned ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();

                // Display results
                loadingIndicator.style.display = 'none';
                diagnosticOutput.classList.remove('loading');

                if (data.diagnostic) {
                    resultsContent.innerHTML = `
                        <h3>Analysis Complete</h3>
                        <div class="card">
                            ${data.diagnostic}
                        </div>
                    `;
                } else {
                    resultsContent.innerHTML = `
                        <div class="error">
                            <strong>Error:</strong> Unexpected response format from server.
                        </div>
                    `;
                }

            } catch (error) {
                // Handle errors
                loadingIndicator.style.display = 'none';
                diagnosticOutput.classList.remove('loading');

                resultsContent.innerHTML = `
                    <div class="error">
                        <strong>Error:</strong> ${error.message}
                        <p class="mt-2">
                            Please ensure the Cloudflare Worker is running on <code>localhost:8787</code>.
                            See the <a href="https://github.com/[your-repo]/README.md">README</a> for setup instructions.
                        </p>
                    </div>
                `;

                console.error('Diagnostic tool error:', error);
            } finally {
                // Reset button state
                submitBtn.disabled = false;
                submitBtn.textContent = 'Analyze Boundary Behaviors';
            }
        });

        // Optional: Reset results when form is modified
        diagnosticForm.addEventListener('input', () => {
            if (resultsContent.innerHTML !== '') {
                // Optionally clear results when user starts editing again
                // resultsSection.style.display = 'none';
            }
        });
    </script>
</body>
</html>
